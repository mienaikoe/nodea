hide id='loadies'
    hide class='loadie' id='samples'
    hide class='loadie' id='ditties'


div id='studio' class='left right bottom top'
  
    div id='machine' class='center'
        div id='ideas'
            =render partial: 'ideas', locals: {}
        div id='circuit'  class='bottom charm'
            =render partial: 'circuit', locals: {}


    div id='sample_drawer' class='drawer right top bottom charm'
    div id='ditty_drawer' class='drawer left top bottom charm'

/
  div id='controls'
    spiv id='controls_center'
      -['beginning','rewind','stop','record','play','forward','end'].each do |control|
        spiv class='control' id="control_#{control}"


  
javascript:
    var bindings = #{raw @samples.map{|s|s ? s.file.url : nil}.to_json};
    var timings = [ // open song 
        [ // open 2/4 bar
            [ // open beat
                { keyOn: '1', time: 0 },
                { keyOn: '2', time: 32 }
            ],
            [ // open beat
                { keyOff: '1', time: 0 },
                { keyOff: '2', time: 32 }
            ]
        ],
        [ // open 3/4 bar
            [], //empty beat
            [], //empty beat
            [], //empty beat
        ],
        [ // open 4/4 bar
            [ // open beat
                { keyOn: '1', time: 0 },
                { keyOn: '2', time: 32 }
            ],
            [], //empty beat
            [], //empty beat
            [ // open beat
                { keyOff: '1', time: 0 },
                { keyOff: '2', time: 32 }
            ]
        ]
    ];
    var beat = 4;
    var bpm = 144;

    var project, ideas, circuit;
    $(function() {
        project = new Project(bindings, timings, beat, bpm);
        ideas = new Ideas(project);
        circuit = new Circuit(project.bindings, ideas);


        // should be able to enter music as a typewriter
        // enter key should skip to next increment a configurable number of times 
        // (smallest chunk is 132)
        $("body").keydown(function(ev) {
            console.log(ev.which);
            if (ev.which < 48 || ev.which > 200) { //perhaps this should be handled by dummy nodas
                return;
            } else if(ev.which === 13){
                ideas.advance();
            }
            circuit.nodas[ev.which].on();
            ev.preventDefault();
        }).keyup(function(ev) {
            if (ev.which < 48 || ev.which > 200) {
                return;
            }
            circuit.nodas[ev.which].off();
        });
    });
