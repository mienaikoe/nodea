
<!DOCTYPE html>
<html>
<head>
  <title>Nodea Studio</title>
  <link  href="/application.css" media="all" rel="stylesheet" />
<link  href="/studio.css" media="all" rel="stylesheet" />
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script  src="ideas.js"></script>
<script  src="noda.js></script>
<script  src="project.js"></script>
<script  src="studio.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
</head>
<body>

  <hide>Header Yay!</hide>
  
  <hide id="loadies"><hide class="loadie" id="samples"></hide><hide class="loadie" id="ditties"></hide></hide><div class="left right bottom top" id="studio"><div class="center" id="machine"><div id="ideas"><div id="tracks"><spiv class="nodeTrack first" id="track_49"></spiv><spiv class="nodeTrack" id="track_50"></spiv><spiv class="nodeTrack" id="track_51"></spiv><spiv class="nodeTrack" id="track_52"></spiv><spiv class="nodeTrack" id="track_53"></spiv><spiv class="nodeTrack" id="track_54"></spiv><spiv class="nodeTrack" id="track_55"></spiv><spiv class="nodeTrack" id="track_56"></spiv><spiv class="nodeTrack" id="track_57"></spiv><spiv class="nodeTrack" id="track_48"></spiv><spiv class="nodeTrack" id="track_113"></spiv><spiv class="nodeTrack" id="track_119"></spiv><spiv class="nodeTrack" id="track_101"></spiv><spiv class="nodeTrack" id="track_114"></spiv><spiv class="nodeTrack" id="track_116"></spiv><spiv class="nodeTrack" id="track_121"></spiv><spiv class="nodeTrack" id="track_117"></spiv><spiv class="nodeTrack" id="track_105"></spiv><spiv class="nodeTrack" id="track_111"></spiv><spiv class="nodeTrack" id="track_112"></spiv><spiv class="nodeTrack" id="track_97"></spiv><spiv class="nodeTrack" id="track_115"></spiv><spiv class="nodeTrack" id="track_100"></spiv><spiv class="nodeTrack" id="track_102"></spiv><spiv class="nodeTrack" id="track_103"></spiv><spiv class="nodeTrack" id="track_104"></spiv><spiv class="nodeTrack" id="track_106"></spiv><spiv class="nodeTrack" id="track_107"></spiv><spiv class="nodeTrack" id="track_108"></spiv><spiv class="nodeTrack" id="track_59"></spiv><spiv class="nodeTrack" id="track_122"></spiv><spiv class="nodeTrack" id="track_120"></spiv><spiv class="nodeTrack" id="track_99"></spiv><spiv class="nodeTrack" id="track_118"></spiv><spiv class="nodeTrack" id="track_98"></spiv><spiv class="nodeTrack" id="track_110"></spiv><spiv class="nodeTrack" id="track_109"></spiv><spiv class="nodeTrack" id="track_44"></spiv><spiv class="nodeTrack" id="track_46"></spiv><spiv class="nodeTrack" id="track_47"></spiv></div><div id="barlines"></div></div><div class="bottom charm" id="circuit"><div id="swytches"><spiv class="trackSwitch first">1</spiv><spiv class="trackSwitch">2</spiv><spiv class="trackSwitch">3</spiv><spiv class="trackSwitch">4</spiv><spiv class="trackSwitch">5</spiv><spiv class="trackSwitch">6</spiv><spiv class="trackSwitch">7</spiv><spiv class="trackSwitch">8</spiv><spiv class="trackSwitch">9</spiv><spiv class="trackSwitch">0</spiv><spiv class="trackSwitch">q</spiv><spiv class="trackSwitch">w</spiv><spiv class="trackSwitch">e</spiv><spiv class="trackSwitch">r</spiv><spiv class="trackSwitch">t</spiv><spiv class="trackSwitch">y</spiv><spiv class="trackSwitch">u</spiv><spiv class="trackSwitch">i</spiv><spiv class="trackSwitch">o</spiv><spiv class="trackSwitch">p</spiv><spiv class="trackSwitch">a</spiv><spiv class="trackSwitch">s</spiv><spiv class="trackSwitch">d</spiv><spiv class="trackSwitch">f</spiv><spiv class="trackSwitch">g</spiv><spiv class="trackSwitch">h</spiv><spiv class="trackSwitch">j</spiv><spiv class="trackSwitch">k</spiv><spiv class="trackSwitch">l</spiv><spiv class="trackSwitch">;</spiv><spiv class="trackSwitch">z</spiv><spiv class="trackSwitch">x</spiv><spiv class="trackSwitch">c</spiv><spiv class="trackSwitch">v</spiv><spiv class="trackSwitch">b</spiv><spiv class="trackSwitch">n</spiv><spiv class="trackSwitch">m</spiv><spiv class="trackSwitch">,</spiv><spiv class="trackSwitch">.</spiv><spiv class="trackSwitch">/</spiv></div><div id="controls"><spiv class="controls_container" id="playback_controls"><spiv class="button_box"><div class="control button" id="reset" onclick="ideas.reset();">&#x982d;</div><div class="label">RESET</div></spiv><spiv class="button_box"><div class="control button" id="playpause" onclick="ideas.playpause();">&#x6f14;</div><div class="label">PLAY</div></spiv></spiv><ditch class="float"></ditch><spiv class="controls_container" id="mode_controls"><spiv class="button_box"><div class="control button" id="record" onclick="ideas.toggleRecording();">&#x9304;</div><div class="label">REC</div></spiv></spiv><ditch class="float"></ditch><spiv class="controls_container" id="beat_controls"><spiv class="wide_box"><input class="control field" id="bpm_box" name="bpm_box" type="number" value="144" /><div class="label">BPM</div></spiv><spiv class="wide_box"><select class="control select" id="advance_box" name="advance_box"><option value="1536">8</option><option value="1152">6</option><option value="768"> 4</option><option value="576"> 3</option><option value="384"> 2</option><option selected="selected" value="192">1</option><option value="96">  &#xBD;</option><option value="64">  &#x2153;</option><option value="48">  &#xBC;</option><option value="32">  &#x2159;</option><option value="24">  &#x215B;</option></select><div class="label">ADVANCEMENT</div></spiv></spiv></div><div id="nodes"><spiv class="nodesContainer" id="bottomleft_nodes"><div class="nodeRow"><spiv class="node" id="key_49">1</spiv><spiv class="node" id="key_50">2</spiv><spiv class="node" id="key_51">3</spiv><spiv class="node" id="key_52">4</spiv><spiv class="node" id="key_53">5</spiv></div><ditch></ditch><div class="nodeRow"><spiv class="node" id="key_113">q</spiv><spiv class="node" id="key_119">w</spiv><spiv class="node" id="key_101">e</spiv><spiv class="node" id="key_114">r</spiv><spiv class="node" id="key_116">t</spiv></div><div class="nodeRow"><spiv class="node" id="key_97">a</spiv><spiv class="node" id="key_115">s</spiv><spiv class="node" id="key_100">d</spiv><spiv class="node" id="key_102">f</spiv><spiv class="node" id="key_103">g</spiv></div><div class="nodeRow"><spiv class="node" id="key_122">z</spiv><spiv class="node" id="key_120">x</spiv><spiv class="node" id="key_99">c</spiv><spiv class="node" id="key_118">v</spiv><spiv class="node" id="key_98">b</spiv></div></spiv><spiv class="nodesContainer" id="bottomright_nodes"><div class="nodeRow"><spiv class="node" id="key_54">6</spiv><spiv class="node" id="key_55">7</spiv><spiv class="node" id="key_56">8</spiv><spiv class="node" id="key_57">9</spiv><spiv class="node" id="key_48">0</spiv></div><ditch></ditch><div class="nodeRow"><spiv class="node" id="key_121">y</spiv><spiv class="node" id="key_117">u</spiv><spiv class="node" id="key_105">i</spiv><spiv class="node" id="key_111">o</spiv><spiv class="node" id="key_112">p</spiv></div><div class="nodeRow"><spiv class="node" id="key_104">h</spiv><spiv class="node" id="key_106">j</spiv><spiv class="node" id="key_107">k</spiv><spiv class="node" id="key_108">l</spiv><spiv class="node" id="key_59">;</spiv></div><div class="nodeRow"><spiv class="node" id="key_110">n</spiv><spiv class="node" id="key_109">m</spiv><spiv class="node" id="key_44">,</spiv><spiv class="node" id="key_46">.</spiv><spiv class="node" id="key_47">/</spiv></div></spiv></div></div></div><div class="drawer right top bottom charm" id="sample_drawer"></div><div class="drawer left top bottom charm" id="ditty_drawer"></div></div><script type="text/javascript">var project = {"bindings":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"/system/samples/files/000/000/003/original/bowy.mp3?1379617880","/system/samples/files/000/000/004/original/chirp.mp3?1379617907","/system/samples/files/000/000/005/original/snare.mp3?1379618488",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"timings":[{"key":"1","on":0,"off":24},{"key":"2","on":32,"off":48},{"key":"1","on":48,"off":95},{"key":"3","on":72,"off":95},{"key":"1","on":96,"off":143},{"key":"3","on":96,"off":108},{"key":"1","on":288,"off":480},{"key":"2","on":144,"off":480}],"beat":4,"numBeats":24,"bpm":144}

var ideas, nodas;

$(function() {     
    nodas = [];

    // DOM-JS Bindings
    var actionPairs = [];
    $("#circuit .node").each(function(i,v) {
        var ascii = $(v).text().toUpperCase().charCodeAt(0);
        actionPairs[ascii] = {noda: $(v)};
    }).click(function() {
        // should control the actions of the key. not play note.
    });

    $("#circuit .trackSwitch").each(function(i,v){
        var ascii = $(v).text().toUpperCase().charCodeAt(0);
        actionPairs[ascii].swytche = $(v);
    }).click(function(){
        // something..?
    });


    // Sample Fetching and Allocation
    var ctx = new webkitAudioContext();
    for( var i in actionPairs ){
        var actionPair = actionPairs[i];
        if( actionPair && actionPair.noda && actionPair.swytche ){
            var nodeNotes = [];
            for( _j in project.timings ){
                if( project.timings[_j].key.toUpperCase().charCodeAt(0).toString() === i ){
                    nodeNotes.push(project.timings[_j]);
                }
            }
            nodas[i] = new Noda(actionPair.noda, actionPair.swytche, ctx, nodeNotes, project.bindings[i]);
        }
    }        


    // Event Handling
    $("body").keydown(function(ev) {
        var ascii = ev.which
        if(ascii === 32){
            ideas.playpause();
        } else if (ascii === 59) {
            ascii = 186;
        } else if (ascii < 48) {
            ascii = ascii + 144;
        } else if( ev.which > 200) { //perhaps this should be handled by dummy nodas
            return;
        } 
        nodas[ascii].on();
        ev.preventDefault();
    }).keyup(function(ev) {
        var ascii = ev.which
        if(ascii === 13){
            ideas.start();
        } else if (ascii === 59) {
            ascii = 186;
        } else if (ascii < 48) {
            ascii = ascii + 144;
        } else if( ev.which > 200) { //perhaps this should be handled by dummy nodas
            return;
        } 
        nodas[ev.which].off();
    });

    $("#bpm_box").
        change(     function(){ project.bpm = parseInt(this.value) } ).
        keydown(    function(ev){ ev.stopPropagation(); }).
        keyup(      function(ev){ ev.stopPropagation(); });

    ideas = new Ideas(project);
});</script>
  
</body>
</html>

