<!DOCTYPE html>
<html>
    <head>
        <title>Nodea Studio</title>

        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        
        <!-- Third Party Assets -->
        <link href="fonts/kiroregular/stylesheet.css" media="all" rel="stylesheet" />
        <link href="fonts/gudea/stylesheet.css" media="all" rel="stylesheet" />
	<script src="lib/jquery-2.1.0.min.js"></script>
		
        <!-- CSS -->
	<link href="css/basics.css" media="all" rel="stylesheet" />
        <link href="css/studio.css" media="all" rel="stylesheet" />
        <link href="effects/Envelope/Envelope.css" media="all" rel="stylesheet" /> 

        <!-- Effect Assets -->
        <script src="effects/EffectsChain.js"></script>
        <script src="effects/Effect/Effect.js"></script>
        <script src="effects/Envelope/Envelope.js"></script>
	<!-- TODO: Delayed Load These -->

        <!-- Core Scripts -->
        <script src="circuits/Circuit/Circuit.js"></script>
        <script src="machines/Machine/Machine.js"></script>
	<script src="core/DrawerUtils.js"></script>
        <script src="core/Metronome.js"></script>
        <script src="core/Note.js"></script>
        <script src="core/UndoList.js"></script>
        <script src="core/DelayedLoad.js"></script>
        <script src="core/Scales.js"></script>
        <script src="core/NodeaStudio.js"></script>
        
    </head>
    <body>

        <div id="studio_center">
            <div id="studio">



                <div id="machine_drawer" class="drawer sinistra">

                    <div class="drawer_heading">
                        <span>Machine Controls</span>
                    </div>
                    <div class="drawer_content" id="machine_controls">

                    </div>

                </div>

                <div id="editor">
                    <div id="idea_window">
                        <div id="ideas"></div>
                    </div>
                    <div class="bottom charm" id="instrumentation">
                        <div id="swytches"></div>
                        <div class="controls" id="edit_controls">
                            
                            <spiv class="group spacer" id="save_controls">
                                <spiv class="button_box">
                                    <div class="control button javascript" id="save" onclick="studio.save();">&#x5b58;</div>
                                    <div class="label">SAVE</div>
                                </spiv>
                            </spiv>

                            <div class="ditch"></div>
                            
                            <spiv class="group spacer" id="mode_controls">
                                <spiv class="button_box">
                                    <div class="control button javascript" id="playpause" onclick="studio.playpause();">&#x6f14;</div>
                                    <div class="label">PLAY</div>
                                </spiv>
                                <spiv class="button_box">
                                    <div class="control button javascript" id="record" onclick="studio.toggleRecording();">&#x9304;</div>
                                    <div class="label">REC</div>
                                </spiv>

                                <spiv class="button_box">
                                    <div class="control button javascript" id="loopToggle" onclick="studio.toggleLooping();">&#x8f2a;</div>
                                    <div class="label">LOOP</div>
                                </spiv>
                            </spiv>

                            <div class="ditch"></div>	

                            <spiv class="group spacer" id="bar_controls">
                                <spiv class="wide_box">
                                    <input class="control field twodigit" max="99" id="bar_size" type="number" value="3" />
                                    <div class="label">BAR SIZE</div>
                                </spiv>
                                <spiv class="wide_box">
                                    <input class="control field threedigit" max="999" id="bar_count" type="number" value="20" />
                                    <div class="label">BAR COUNT</div>
                                </spiv>
                            </spiv>

                            <div class="ditch"></div>

                            <spiv class="group spacer" id="beat_controls">
                                <spiv class="wide_box">
                                    <input class="control field threedigit" max="999" id="bpm" type="number" value="130" />
                                    <div class="label">BPM</div>
                                </spiv>
                                <spiv class="button_box">
                                    <div class="control button javascript" id="metronome" onclick="studio.metronome.toggleArmament();">&#x62dc;</div>
                                    <div class="label">METRO</div>
                                </spiv>
                            </spiv>

                            <div class="ditch"></div>

                            <spiv class="group spacer" id="playback_controls">
                                <spiv class="wide_box">
                                    <select class="control select" id="advance_box" name="advance_box">
                                        <option value="1_bar">Bar</option>
                                        <option value="3_beat">3</option>
                                        <option value="2_beat">2</option>
                                        <option selected="selected" value="1_beat">1</option>
                                        <option value="12_pixel">1/2</option>
                                        <option value="8_pixel">1/3</option>
                                        <option value="6_pixel">1/4</option>
                                        <option value="4_pixel">1/6</option>
                                        <option value="3_pixel">1/8</option>
                                        <option value="2_pixel">1/12</option>
                                        <option value="1_pixel">1/24</option>
                                    </select>
                                    <div class="label">ADVANCEMENT</div>
                                </spiv>
                                <spiv class="button_box">
                                    <div class="control button" id="head" onclick="studio.head();">&#x982d;</div>
                                    <div class="label">HEAD</div>
                                </spiv>
                                <spiv class="button_box">
                                    <div class="control button" id="tail" onclick="studio.tail();">&#x672b;</div>
                                    <div class="label">TAIL</div>
                                </spiv>
                            </spiv>

                            <div class="ditch"></div>

                            <spiv class="group spacer" id="snap_controls">
                                <spiv class="wide_box">
                                    <select class="control select" id="snap_resolution_box" name="snap_resolution_box">
                                        <option value="24">1</option>
                                        <option value="12">1/2</option>
                                        <option value="8">1/3</option>
                                        <option value="6">1/4</option>
                                        <option value="4">1/6</option>
                                        <option value="3">1/8</option>
                                        <option value="2">1/12</option>
                                        <option selected="selected" value="1">1/24</option>
                                    </select>
                                    <div class="label">SNAP TO</div>
                                </spiv>
                                <spiv class="button_box">
                                    <div class="control button" id="snap" onclick="studio.snap();">&#x982d;</div>
                                    <div class="label">SNAP</div>
                                </spiv>
                            </spiv>

                        </div>
                        <div id="machines"></div>
                        <div id="circuits"></div>
                    </div>

                </div>

                <div id="circuit_drawer" class="drawer dextra">

                    <div class="drawer_heading">
                        <span>Circuit Controls</span>
                    </div>
                    <div class="drawer_content" id="circuit_controls">

                    </div>

                </div>
            </div>
        </div>

        <script type="text/javascript">
            $('.control.button:not(.javascript)').
                    mousedown(function() {
                        $(this).addClass('active');
                    }).
                    mouseup(function() {
                        $(this).removeClass('active');
                    });

            var studio;


            var projectStr = window.localStorage.defaultProject;
            var project = null;
            if (projectStr === null || projectStr === undefined) {
                project = {
                    "project_id": 1,
                    "name": "Test Project",
                    "description": "Initial Project for Testing purposes",
                    "beats_per_minute": 130,
                    "beats_per_bar": 3,
                    "keyset": "desktop",
                    "bar_count": 20,
                    "machines": {
                        48: {
                            handle: "Uncharted",
                            circuits: {
                                60: {
                                    handle: "Oscillator", 
                                    frequency: 440
                                }
                            }
                        }
                    },
                    "nodas": [{
                            "ordinal": 49,
                            "handle": "Sampler",
                            "settings": {
                                "sourceFile": "http://upload.wikimedia.org/wikipedia/commons/6/66/Mango.ogg"
                            },
                            "notes": [{
                                    "start": 50,
                                    "finish": 73
                                },
                                {
                                    "start": 83,
                                    "finish": 117
                                }]
                        },
                        {
                            "ordinal": 50,
                            "handle": "Sampler",
                            "settings": {
                                "sourceFile": "http://upload.wikimedia.org/wikipedia/commons/3/33/Mangos.ogg"
                            },
                            "notes": [{
                                    "start": 51,
                                    "finish": 74
                                },
                                {
                                    "start": 84,
                                    "finish": 118
                                }]
                        },
                        {
                            "ordinal": 51,
                            "handle": "Sampler",
                            "settings": {
                                "sourceFile": "http://upload.wikimedia.org/wikipedia/commons/c/cb/Sugar2.ogg"
                            },
                            "notes": [{
                                    "start": 52,
                                    "finish": 75
                                },
                                {
                                    "start": 85,
                                    "finish": 119
                                },
                                {
                                    "start": 0,
                                    "finish": 40
                                }]
                        }]
                };
            } else {
                project = JSON.parse(projectStr);
            }
            $(function() {
                studio = new NodeaStudio(document.getElementById("editor"), project);
            });</script>

    </body>
</html>
